# 深入理解linux网络内幕，网络部分  

## 路由-概念

路由器就是使用多块网络接口卡(Network Interface Card)用来转发入口流量的设备。其转发是依据内部的转发信息库(Forwading Information Base),来进行流浪的转发，也叫做路由表。使用路由表的软件就可以被成为路由协议(routing portocol)。  

路由的配置在书中分成了三种。第一种是每个接口都对应一个子网。第二种在同一个局域网中有两个接口，但是这两个接口连接的局域网是不同的。第三种是一个NIC上配置了多个子网。在第三种情况下，如果收到数据包广播，那么同一个NIC上的机器都会收到广播。还有就是接口和入口不一定非要是不同的NIC可以从同一个NIC发送与接收。  

书中还提到了7个问题：  

- 如果假定一台路由器要转发包，linux内核是如何知道能否转发？

- 路由是对全局使用还是对一对接口使用？  

- 是否存在可以调整的参数，可以显著的影响linux路由的性能?

- 路由表的结构是什么样的？  

- 转发包信息使用的算法？  -- 最长前缀算法

- 路由除了转发流量之外的其他用途？  

- 内核与用户空间的动态路由协议是如何交互的？  

可路由地址和不可路由地址在IP的规范中已经指定：  

- 10.0.0.0/8  

- 172.16.0.0/16 ~ 173.31.0.0/16  

- 192.168.0.0/16  

- 127.0.0.0/8  

其中127.0.0.0比较特殊，这个ip无论是目的还是源ip含有这个ip，主机都不会转发这个数据包。  

scope共有三个值，分别是主机、链路和全域。用来进行路由路径的检查。

主地址和辅助地址。在将一个NIC配置上多个地址时就会发生这种情况，如果两个地址没什么区别（例如192.168.1.2/24 和 192.168.1.3/24），那么后被添加的是辅助地址。但是如果在加入一个192.168.1.5/25的地址，那么这个地址也是会被当做一个主要地址。  

别名例如eth0 eth0:1 是使用之前的ifconfig命令来实现的，而辅助IP是使用比较新的iprout2软件进行设置的，而ifconfig对于别名当做一种全新的设备，而对辅助而言，别名只不过是一种符号而已。
